<!doctype html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MyYieldBank â€” MVP ì™€ì´ì–´í”„ë ˆì„ (í•œê¸€ í’€ UI)</title>
  <style>
    :root{
      --bg:#0b1220;
      --panel:#0f1a30;
      --panel2:#0c162b;
      --text:#eaf0ff;
      --muted:#9fb0d0;
      --line:rgba(255,255,255,.10);
      --good:#38d996;
      --bad:#ff5b6e;
      --accent:#ffd34e;
      --chip:#142447;
      --shadow: 0 12px 30px rgba(0,0,0,.35);
      --radius:18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Apple SD Gothic Neo", "Noto Sans KR", Arial, sans-serif;
      background: radial-gradient(1200px 600px at 20% -10%, rgba(255,211,78,.20), transparent 60%),
                  radial-gradient(900px 500px at 100% 10%, rgba(56,217,150,.18), transparent 55%),
                  var(--bg);
      color:var(--text);
      overflow-x:hidden;
    }
    a{color:inherit;text-decoration:none}
    .app{max-width:1100px;margin:0 auto;padding:18px 16px 92px}

    /* ìƒë‹¨ë°” */
    .topbar{
      display:flex;align-items:center;justify-content:space-between;gap:12px;
      position:sticky;top:0;z-index:10;padding:14px 0 12px;
      background: linear-gradient(to bottom, rgba(11,18,32,.92), rgba(11,18,32,.55), transparent);
      backdrop-filter: blur(8px);
    }
    .brand{display:flex;align-items:center;gap:12px}
    .logo{
      width:42px;height:42px;border-radius:14px;
      background: linear-gradient(135deg, rgba(255,211,78,.95), rgba(56,217,150,.85));
      box-shadow: var(--shadow);
      display:grid;place-items:center;color:#0b1220;font-weight:900;
      user-select:none;
    }
    .brand h1{margin:0;font-size:16px;letter-spacing:.2px}
    .brand p{margin:2px 0 0;color:var(--muted);font-size:12px}
    .actions{display:flex;gap:10px;align-items:center;flex-wrap:wrap;justify-content:flex-end}
    .pill{
      border:1px solid var(--line);background: rgba(255,255,255,.04);
      padding:10px 12px;border-radius:999px;display:flex;gap:8px;align-items:center;
      color:var(--muted);font-size:12px;white-space:nowrap;
    }
    .btn{
      border:1px solid var(--line);background: rgba(255,255,255,.06);
      padding:10px 12px;border-radius:12px;font-size:12px;color:var(--text);
      cursor:pointer;
    }
    .btn:hover{filter:brightness(1.08)}
    .btn.accent{border-color: rgba(255,211,78,.45);background: rgba(255,211,78,.12)}
    .btn.danger{border-color: rgba(255,91,110,.45);background: rgba(255,91,110,.10)}

    /* ë ˆì´ì•„ì›ƒ */
    .grid{display:grid;grid-template-columns: 1.35fr .85fr;gap:14px;margin-top:6px}
    @media (max-width: 920px){.grid{grid-template-columns:1fr}}

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--line);border-radius: var(--radius);
      box-shadow: var(--shadow);overflow:hidden;
    }
    .card .hd{
      padding:14px 14px 10px;display:flex;align-items:flex-start;justify-content:space-between;gap:10px;
      border-bottom:1px solid var(--line);background: rgba(0,0,0,.10);
    }
    .card .hd .t{display:flex;flex-direction:column;gap:3px}
    .card .hd .t .title{font-weight:900;font-size:13px}
    .card .hd .t .sub{font-size:12px;color:var(--muted)}
    .card .bd{padding:14px}

    .row{display:flex;gap:10px;flex-wrap:wrap}
    .kpi{
      flex:1;min-width:160px;padding:12px;border:1px solid var(--line);
      background: rgba(15,26,48,.55);border-radius:16px;
    }
    .kpi .label{font-size:12px;color:var(--muted)}
    .kpi .value{margin-top:6px;font-size:18px;font-weight:900;letter-spacing:.2px}
    .kpi .hint{margin-top:6px;font-size:12px;color:var(--muted)}
    .tag{
      display:inline-flex;align-items:center;gap:6px;padding:6px 10px;border-radius:999px;
      background: rgba(20,36,71,.75);border:1px solid var(--line);
      font-size:12px;color:var(--muted);white-space:nowrap;
    }
    .dot{width:8px;height:8px;border-radius:99px;background:var(--accent)}
    .dot.good{background:var(--good)}
    .dot.bad{background:var(--bad)}
    .divider{height:1px;background:var(--line);margin:12px 0}

    .list{display:flex;flex-direction:column;gap:10px}
    .item{
      border:1px solid var(--line);background: rgba(12,22,43,.65);
      border-radius:16px;padding:12px;display:flex;justify-content:space-between;gap:12px;align-items:center;
    }
    .item .l{display:flex;flex-direction:column;gap:4px}
    .item .name{font-weight:900;font-size:13px}
    .item .meta{font-size:12px;color:var(--muted);display:flex;gap:8px;flex-wrap:wrap}
    .item .r{text-align:right}
    .item .price{font-weight:900}
    .item .chg{font-size:12px;margin-top:4px}
    .chg.good{color:var(--good)}
    .chg.bad{color:var(--bad)}
    .mini-btns{display:flex;gap:8px;margin-top:8px;justify-content:flex-end;flex-wrap:wrap}
    .mini{
      font-size:12px;padding:8px 10px;border-radius:12px;border:1px solid var(--line);
      background: rgba(255,255,255,.05);color:var(--text);cursor:pointer;
    }
    .mini.danger{
      border-color: rgba(255,91,110,.45);background: rgba(255,91,110,.10)
    }

    .form{display:grid;gap:10px}
    label{font-size:12px;color:var(--muted)}
    input, textarea, select{
      width:100%;padding:10px 12px;border-radius:14px;border:1px solid var(--line);
      background: rgba(255,255,255,.04);color: var(--text);outline:none;
    }
    textarea{min-height:96px;resize:vertical}
    .two{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    @media (max-width: 520px){.two{grid-template-columns:1fr}}

    /* í•˜ë‹¨ ë©”ë‰´ */
    .bottom-nav{
      position:fixed;left:0;right:0;bottom:0;
      background: rgba(11,18,32,.78);backdrop-filter: blur(10px);
      border-top:1px solid var(--line);padding:10px 10px 14px;z-index:20;
    }
    .nav{max-width:1100px;margin:0 auto;display:flex;gap:8px;justify-content:space-between}
    .nav a{
      flex:1;display:flex;flex-direction:column;align-items:center;gap:6px;
      padding:10px 8px;border-radius:16px;border:1px solid transparent;
      color:var(--muted);font-size:12px;min-width:70px;user-select:none;
    }
    .nav a.active{
      color:var(--text);border-color: rgba(255,211,78,.35);background: rgba(255,211,78,.10);
    }
    .ico{
      width:28px;height:28px;border-radius:12px;border:1px solid var(--line);
      background: rgba(255,255,255,.05);display:grid;place-items:center;
      font-weight:900;font-size:12px;
    }

    /* ëª¨ë‹¬ */
    .modal-backdrop{
      position:fixed;inset:0;background: rgba(0,0,0,.55);
      display:none;align-items:center;justify-content:center;padding:16px;z-index:100;
    }
    .modal-backdrop.show{display:flex}
    .modal{
      width:min(560px, 100%);background: rgba(12,22,43,.96);
      border:1px solid var(--line);border-radius: 22px;box-shadow: var(--shadow);overflow:hidden;
    }
    .modal .mh{
      padding:14px 14px 10px;border-bottom:1px solid var(--line);
      display:flex;align-items:flex-start;justify-content:space-between;gap:10px;
      background: rgba(0,0,0,.18);
    }
    .modal .mh .title{font-weight:900;font-size:13px}
    .modal .mh .sub{font-size:12px;color:var(--muted);margin-top:3px}
    .modal .mb{padding:14px}
    .modal .mf{
      padding:12px 14px;border-top:1px solid var(--line);
      display:flex;gap:10px;justify-content:flex-end;flex-wrap:wrap;background: rgba(0,0,0,.12);
    }

    /* í˜ì´ì§€ */
    .page{display:none}
    .page.active{display:block}
    .note{font-size:12px;color:var(--muted);line-height:1.45}
    .hintline{display:flex;gap:10px;flex-wrap:wrap;align-items:center;justify-content:space-between}
    .split{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    @media (max-width:920px){.split{grid-template-columns:1fr}}
    .small{font-size:12px;color:var(--muted)}
    .kbd{
      border:1px solid var(--line);background: rgba(255,255,255,.05);
      padding:2px 8px;border-radius:999px;font-size:12px;color:var(--muted);
    }
  </style>
</head>

<body>
  <div class="app">
    <header class="topbar">
      <div class="brand">
        <div class="logo">YB</div>
        <div>
          <h1>MyYieldBank</h1>
          <p>â€œì€í–‰ì¥ì€ ë„ˆì•¼. ì•±ì€ ê·œì¹™ì„ ê°ì‹œí•˜ê³  ê¸°ë¡ë§Œ í•´.â€</p>
        </div>
      </div>

      <div class="actions">
        <div class="pill" title="ìƒíƒœ">
          <span class="dot good"></span>
          <span id="pillBanker">ì€í–‰ì¥: ë‚˜</span>
          <span style="opacity:.6">â€¢</span>
          <span>ëª¨ë“œ: MVP</span>
        </div>
        <button class="btn accent" id="btnOpenAdd">+ ì¢…ëª© ì¶”ê°€</button>
        <button class="btn" id="btnGoSettings">âš™ ì„¤ì •</button>
      </div>
    </header>

    <main>
      <!-- í™ˆ -->
      <section class="page active" id="page-home">
        <div class="grid">
          <section class="card">
            <div class="hd">
              <div class="t">
                <div class="title">ëŒ€ì‹œë³´ë“œ (í™ˆ)</div>
                <div class="sub">ì˜¤ëŠ˜ ìš”ì•½ Â· ê·œì¹™ ê°ì‹œ í˜„í™©</div>
              </div>
              <span class="tag" id="tagDefaultRules"><span class="dot"></span> ê¸°ë³¸ ê·œì¹™: +3.5% / -3%</span>
            </div>

            <div class="bd">
              <div class="row">
                <div class="kpi">
                  <div class="label">ê·œì¹™ ì•Œë¦¼</div>
                  <div class="value" id="kpiAlerts">0</div>
                  <div class="hint">ìµì ˆ ë„ë‹¬ / ì†ì ˆ ê²½ê³ </div>
                </div>
                <div class="kpi">
                  <div class="label">ë“±ë¡ ì¢…ëª©</div>
                  <div class="value" id="kpiAssets">0</div>
                  <div class="hint">ë„¤ê°€ ë“±ë¡í•œ ì¢…ëª©ë§Œ</div>
                </div>
                <div class="kpi">
                  <div class="label">í‰ê·  ìˆ˜ìµë¥  (ëª¨ì˜)</div>
                  <div class="value" id="kpiPL">+0.0%</div>
                  <div class="hint">ì™€ì´ì–´í”„ë ˆì„ìš©</div>
                </div>
              </div>

              <div class="divider"></div>

              <div class="hintline">
                <div>
                  <div style="font-weight:900;margin-bottom:6px">ë‚´ ì€í–‰ ì¢…ëª©</div>
                  <div class="note">ì¶”ì²œ ì—†ìŒ. ë„¤ ê·œì¹™ì— ë”°ë¼ ê°ì‹œ/ì‹ í˜¸ë§Œ ì œê³µ.</div>
                </div>
                <span class="tag"><span class="dot bad"></span> ë¦¬ë”©/ë§¤ìˆ˜ì¶”ì²œ ì—†ìŒ</span>
              </div>

              <div style="height:10px"></div>

              <div class="list" id="homeAssets"></div>

              <div class="divider"></div>

              <div style="font-weight:900;margin-bottom:10px">ë¹ ë¥¸ ì‹¤í–‰</div>
              <div class="row">
                <button class="btn" id="qaAdd">+ ì¢…ëª© ì¶”ê°€</button>
                <button class="btn" id="qaRules">ê¸°ë³¸ ê·œì¹™ ìˆ˜ì •</button>
                <button class="btn" id="qaJournal">ë§¤ë§¤ì¼ì§€ ì—´ê¸°</button>
                <button class="btn" id="qaExport">JSON ë‚´ë³´ë‚´ê¸°</button>
              </div>
              <div class="note" style="margin-top:10px">
                íŒ: í•˜ë‹¨ ë©”ë‰´ë¡œ í˜ì´ì§€ ì´ë™. ë°ì´í„°ëŠ” LocalStorage(ë°ëª¨)ì— ì €ì¥ë¼.
              </div>
            </div>
          </section>

          <aside class="card">
            <div class="hd">
              <div class="t">
                <div class="title">ê·œì¹™ ì•Œë¦¼ & ë§¤ë§¤ì¼ì§€</div>
                <div class="sub">íŒë‹¨ì´ ì•„ë‹Œ ê¸°ë¡ì˜ ê³µê°„</div>
              </div>
              <span class="tag">ì¡°ì–¸ ì—†ìŒ</span>
            </div>

            <div class="bd">
              <div style="font-weight:900;margin-bottom:10px">ê·œì¹™ ì•Œë¦¼</div>
              <div class="list" id="homeAlerts"></div>

              <div class="divider"></div>

              <div style="font-weight:900;margin-bottom:10px">ìµœê·¼ ê¸°ë¡</div>
              <div class="list" id="homeJournal"></div>

              <div class="divider"></div>

              <div style="font-weight:900;margin-bottom:8px">ì€í–‰ ìš´ì˜ ì›ì¹™</div>
              <ul class="note" style="margin:0; padding-left:18px">
                <li>ì¢…ëª© ì„ íƒì€ ì€í–‰ì¥(ë„ˆ) ì±…ì„</li>
                <li>ì•±ì€ ë“±ë¡ ì¢…ëª©ë§Œ ì¶”ì </li>
                <li>ì¶”ì²œ/ë­í‚¹/ë¦¬ë”© ì—†ìŒ</li>
                <li>ê·œì¹™ ê°ì‹œì™€ ê¸°ë¡ë§Œ</li>
              </ul>
            </div>
          </aside>
        </div>
      </section>

      <!-- ì¢…ëª© -->
      <section class="page" id="page-assets">
        <div class="card">
          <div class="hd">
            <div class="t">
              <div class="title">ì¢…ëª©</div>
              <div class="sub">ë‚´ ì€í–‰ì˜ ì¢…ëª©(ì§ì ‘ ë“±ë¡í•œ ê²ƒë§Œ)</div>
            </div>
            <div class="row">
              <span class="tag"><span class="dot good"></span> ìµì ˆ</span>
              <span class="tag"><span class="dot bad"></span> ì†ì ˆ</span>
            </div>
          </div>

          <div class="bd">
            <div class="hintline">
              <div class="note">
                ì—¬ê¸°ëŠ” â€œì¢…ëª© ê´€ë¦¬â€ ì „ìš©. ì¶”ì²œ/ë­í‚¹ ì—†ìŒ. <span class="kbd">Ctrl/âŒ˜ + K</span>ë¡œë„ ì¶”ê°€ ê°€ëŠ¥.
              </div>
              <div class="row">
                <button class="btn accent" id="assetsAdd">+ ì¢…ëª© ì¶”ê°€</button>
                <button class="btn" id="assetsMock">ğŸ² ëª¨ì˜ ê°€ê²©</button>
              </div>
            </div>

            <div class="divider"></div>
            <div class="list" id="assetsList"></div>
          </div>
        </div>
      </section>

      <!-- ì•Œë¦¼ -->
      <section class="page" id="page-alerts">
        <div class="card">
          <div class="hd">
            <div class="t">
              <div class="title">ì•Œë¦¼</div>
              <div class="sub">ê·œì¹™ ê°ì‹œ ê²°ê³¼ë§Œ í‘œì‹œ(íŒë‹¨ì€ ì•ˆ í•¨)</div>
            </div>
            <span class="tag" id="alertsCountTag">0ê±´</span>
          </div>
          <div class="bd">
            <div class="note" style="margin-bottom:10px">
              ì‹¤ì œ MVPì—ì„  ì‹¤ì‹œê°„ ê°€ê²© ì—°ë™ìœ¼ë¡œ ìƒì„±ë  ì˜ì—­.
            </div>
            <div class="list" id="alertsList"></div>
          </div>
        </div>
      </section>

      <!-- ë§¤ë§¤ì¼ì§€ -->
      <section class="page" id="page-journal">
        <div class="card">
          <div class="hd">
            <div class="t">
              <div class="title">ë§¤ë§¤ì¼ì§€</div>
              <div class="sub">ìˆ˜ìµ ìë‘ì´ ì•„ë‹ˆë¼ â€œê·œì¹™ ì¤€ìˆ˜â€ ê¸°ë¡</div>
            </div>
            <button class="btn accent" id="journalNew">+ ìƒˆ ê¸°ë¡</button>
          </div>
          <div class="bd">
            <div class="split">
              <div>
                <div style="font-weight:900;margin-bottom:8px">ê¸°ë¡ ì‘ì„±</div>
                <div class="form">
                  <div class="two">
                    <div>
                      <label>ê¸°ë¡ ìœ í˜•</label>
                      <select id="jType">
                        <option value="buy">ë§¤ìˆ˜ ì´ìœ </option>
                        <option value="sell">ë§¤ë„ ì´ìœ </option>
                        <option value="rule">ê·œì¹™ ë³€ê²½</option>
                        <option value="memo">ë©”ëª¨</option>
                      </select>
                    </div>
                    <div>
                      <label>ê´€ë ¨ ì¢…ëª© (ì„ íƒ)</label>
                      <select id="jAsset"></select>
                    </div>
                  </div>
                  <div>
                    <label>ê¸°ë¡ ë‚´ìš©</label>
                    <textarea id="jText" placeholder="ì˜ˆ) +3.5% ë„ë‹¬í•˜ë©´ ê¸°ê³„ì ìœ¼ë¡œ ìµì ˆ. ê°ì • ê°œì… ê¸ˆì§€."></textarea>
                  </div>
                  <div class="row" style="justify-content:flex-end">
                    <button class="btn" id="journalClear">ì´ˆê¸°í™”</button>
                    <button class="btn accent" id="journalSave">ì €ì¥</button>
                  </div>
                  <div class="note">ì €ì¥ì€ LocalStorage(ë°ëª¨). ì‹¤ì œ ì„œë¹„ìŠ¤ëŠ” ì„œë²„/DB ì €ì¥.</div>
                </div>
              </div>

              <div>
                <div style="font-weight:900;margin-bottom:8px">ê¸°ë¡ ëª©ë¡</div>
                <div class="list" id="journalList"></div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- ê·œì¹™ -->
      <section class="page" id="page-rules">
        <div class="card">
          <div class="hd">
            <div class="t">
              <div class="title">ê·œì¹™</div>
              <div class="sub">ê¸°ë³¸ ê·œì¹™ + ì¢…ëª©ë³„ ê°œë³„ ê·œì¹™</div>
            </div>
            <span class="tag"><span class="dot"></span> ì€í–‰ì¥ ê·œì¹™</span>
          </div>
          <div class="bd">
            <div class="split">
              <div class="card" style="border-radius:18px">
                <div class="hd">
                  <div class="t">
                    <div class="title">ê¸°ë³¸ ê·œì¹™</div>
                    <div class="sub">ì¢…ëª©ë³„ ê·œì¹™ì´ ì—†ìœ¼ë©´ ì´ ê·œì¹™ ì ìš©</div>
                  </div>
                </div>
                <div class="bd">
                  <div class="two">
                    <div>
                      <label>ìµì ˆ (%)</label>
                      <input id="ruleTP" type="number" step="0.1" />
                    </div>
                    <div>
                      <label>ì†ì ˆ (%)</label>
                      <input id="ruleSL" type="number" step="0.1" />
                    </div>
                  </div>
                  <div style="height:10px"></div>
                  <div class="row" style="justify-content:flex-end">
                    <button class="btn" id="rulesReset">ì´ˆê¸°ê°’</button>
                    <button class="btn accent" id="rulesSave">ì €ì¥</button>
                  </div>
                  <div class="note">ê¶Œì¥ ì˜ˆ: ìµì ˆ +3~4%, ì†ì ˆ -3%</div>
                </div>
              </div>

              <div class="card" style="border-radius:18px">
                <div class="hd">
                  <div class="t">
                    <div class="title">ì¢…ëª©ë³„ ê°œë³„ ê·œì¹™</div>
                    <div class="sub">ì¢…ëª© ì„ íƒ í›„ ê°œë³„ ê·œì¹™ ì„¤ì •</div>
                  </div>
                </div>
                <div class="bd">
                  <div class="form">
                    <div>
                      <label>ì¢…ëª©</label>
                      <select id="ovAsset"></select>
                    </div>
                    <div class="two">
                      <div>
                        <label>ìµì ˆ (%)</label>
                        <input id="ovTP" type="number" step="0.1" placeholder="ë¹„ìš°ë©´ ê¸°ë³¸ ê·œì¹™" />
                      </div>
                      <div>
                        <label>ì†ì ˆ (%)</label>
                        <input id="ovSL" type="number" step="0.1" placeholder="ë¹„ìš°ë©´ ê¸°ë³¸ ê·œì¹™" />
                      </div>
                    </div>
                    <div class="row" style="justify-content:flex-end">
                      <button class="btn danger" id="ovClear">ê°œë³„ ê·œì¹™ í•´ì œ</button>
                      <button class="btn accent" id="ovSave">ì €ì¥</button>
                    </div>
                    <div class="note">ì¶”ì²œ ì—†ìŒ. ì„ íƒ/ì±…ì„ì€ ì€í–‰ì¥(ë„ˆ)ì—ê²Œ.</div>
                  </div>
                </div>
              </div>
            </div>

            <div class="divider"></div>
            <div class="note">
              ë‹¤ìŒ ë‹¨ê³„: ì‹¤ì‹œê°„ ê°€ê²© ì—°ë™ â†’ ê·œì¹™ ì—”ì§„ â†’ ì•Œë¦¼(í‘¸ì‹œ) â†’ ê±°ë˜ ë¡œê·¸/ë¦¬í¬íŠ¸.
            </div>
          </div>
        </div>
      </section>

      <!-- ì„¤ì • -->
      <section class="page" id="page-settings">
        <div class="card">
          <div class="hd">
            <div class="t">
              <div class="title">ì„¤ì •</div>
              <div class="sub">ì€í–‰ì¥ ì •ë³´ Â· ê³ ì§€ Â· ë°ì´í„°</div>
            </div>
            <button class="btn danger" id="wipeAll">ë¡œì»¬ ë°ì´í„° ì´ˆê¸°í™”</button>
          </div>
          <div class="bd">
            <div class="split">
              <div>
                <div style="font-weight:900;margin-bottom:8px">ì€í–‰ì¥</div>
                <div class="form">
                  <div>
                    <label>ì€í–‰ì¥ ì´ë¦„</label>
                    <input id="bankerName" placeholder="ì˜ˆ) ë§ˆì€ì" />
                  </div>
                  <div>
                    <label>ìš´ì˜ ì›ì¹™(ê³ ì • ë¬¸êµ¬)</label>
                    <textarea id="bankerPrinciple">MyYieldBankëŠ” íˆ¬ìë¥¼ ëŒ€ì‹ í•˜ì§€ ì•ŠëŠ”ë‹¤.
ì‚¬ìš©ìëŠ” ì€í–‰ì¥ì´ì ìœ ì¼í•œ ê³ ê°ì´ë‹¤.
ì„œë¹„ìŠ¤ëŠ” íŒë‹¨ì´ ì•„ë‹Œ ê·œì¹™ ê°ì‹œì™€ ê¸°ë¡ë§Œ ë‹´ë‹¹í•œë‹¤.</textarea>
                  </div>
                  <div class="row" style="justify-content:flex-end">
                    <button class="btn accent" id="saveSettings">ì €ì¥</button>
                  </div>
                </div>
              </div>

              <div>
                <div style="font-weight:900;margin-bottom:8px">ë°ì´í„°</div>
                <div class="note" style="margin-bottom:10px">
                  ì™€ì´ì–´í”„ë ˆì„(ë°ëª¨). ì‹¤ì œ ì„œë¹„ìŠ¤ëŠ” ë³´ì•ˆ/ë™ì˜ UIê°€ ë°˜ë“œì‹œ í•„ìš”.
                </div>
                <div class="card" style="border-radius:18px">
                  <div class="hd">
                    <div class="t">
                      <div class="title">ë‚´ë³´ë‚´ê¸°/ê°€ì ¸ì˜¤ê¸°</div>
                      <div class="sub">JSON íŒŒì¼ë¡œ ë°±ì—…/ë³µì›</div>
                    </div>
                  </div>
                  <div class="bd">
                    <div class="row">
                      <button class="btn" id="exportBtn">JSON ë‚´ë³´ë‚´ê¸°</button>
                      <button class="btn" id="importBtn">JSON ê°€ì ¸ì˜¤ê¸°</button>
                    </div>
                    <div style="height:10px"></div>
                    <input type="file" id="importFile" accept="application/json" style="display:none" />
                    <div class="note">ë¸Œë¼ìš°ì € LocalStorageì— ì €ì¥ë¨.</div>
                  </div>
                </div>

                <div class="divider"></div>
                <div class="note">
                  ì£¼ì†Œì°½ í•´ì‹œë¡œ ì´ë™: <span class="kbd">#home</span>, <span class="kbd">#assets</span>, <span class="kbd">#alerts</span>, <span class="kbd">#journal</span>, <span class="kbd">#rules</span>, <span class="kbd">#settings</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <footer class="bottom-nav">
    <nav class="nav" aria-label="ë©”ì¸ ë©”ë‰´">
      <a data-route="home" class="active" href="#home"><div class="ico">ğŸ¦</div><div>í™ˆ</div></a>
      <a data-route="assets" href="#assets"><div class="ico">ğŸ“‹</div><div>ì¢…ëª©</div></a>
      <a data-route="alerts" href="#alerts"><div class="ico">ğŸ””</div><div>ì•Œë¦¼</div></a>
      <a data-route="journal" href="#journal"><div class="ico">ğŸ“</div><div>ë§¤ë§¤ì¼ì§€</div></a>
      <a data-route="rules" href="#rules"><div class="ico">âš™</div><div>ê·œì¹™</div></a>
    </nav>
  </footer>

  <!-- ì¢…ëª© ì¶”ê°€ ëª¨ë‹¬ -->
  <div class="modal-backdrop" id="addModal">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="addTitle">
      <div class="mh">
        <div>
          <div class="title" id="addTitle">ì¢…ëª© ì¶”ê°€</div>
          <div class="sub">ì§ì ‘ ë“±ë¡í•œ ì¢…ëª©ë§Œ ì¶”ì í•´</div>
        </div>
        <button class="btn" id="addClose">âœ•</button>
      </div>
      <div class="mb">
        <div class="form">
          <div class="two">
            <div><label>ì¢…ëª©ëª…</label><input id="aName" placeholder="ì˜ˆ) ì‚¼ì„±ì „ì" /></div>
            <div><label>í‹°ì»¤(ì„ íƒ)</label><input id="aTicker" placeholder="ì˜ˆ) 005930" /></div>
          </div>
          <div class="two">
            <div><label>ë§¤ìˆ˜ê°€(í‰ê· )</label><input id="aAvg" type="number" step="1" placeholder="ì˜ˆ) 72000" /></div>
            <div><label>í˜„ì¬ê°€(ëª¨ì˜)</label><input id="aNow" type="number" step="1" placeholder="ì˜ˆ) 74520" /></div>
          </div>
          <div class="note">ê°œë³„ ê·œì¹™ì€ [ê·œì¹™] íƒ­ì—ì„œ ì¢…ëª©ë³„ë¡œ ì„¤ì •í•´.</div>
        </div>
      </div>
      <div class="mf">
        <button class="btn" id="addCancel">ì·¨ì†Œ</button>
        <button class="btn accent" id="addSave">ì €ì¥</button>
      </div>
    </div>
  </div>

  <script>
    const STORAGE_KEY = "myyieldbank_wireframe_kr_full_v1";
    const $ = (sel, root=document) => root.querySelector(sel);
    const $$ = (sel, root=document) => Array.from(root.querySelectorAll(sel));
    const routes = ["home","assets","alerts","journal","rules","settings"];

    const rid = () => Math.random().toString(16).slice(2) + "-" + Date.now().toString(16);

    const ê¸°ë³¸ìƒíƒœ = () => ({
      ì€í–‰ì¥: {
        ì´ë¦„: "ë‚˜",
        ì›ì¹™: `MyYieldBankëŠ” íˆ¬ìë¥¼ ëŒ€ì‹ í•˜ì§€ ì•ŠëŠ”ë‹¤.
ì‚¬ìš©ìëŠ” ì€í–‰ì¥ì´ì ìœ ì¼í•œ ê³ ê°ì´ë‹¤.
ì„œë¹„ìŠ¤ëŠ” íŒë‹¨ì´ ì•„ë‹Œ ê·œì¹™ ê°ì‹œì™€ ê¸°ë¡ë§Œ ë‹´ë‹¹í•œë‹¤.`
      },
      ê·œì¹™: { ìµì ˆ: 3.5, ì†ì ˆ: -3.0 },
      ì¢…ëª©: [
        { id: rid(), ì´ë¦„:"ì‚¼ì„±ì „ì", í‹°ì»¤:"005930", ë§¤ìˆ˜ê°€:72000, í˜„ì¬ê°€:74520, ê°œë³„ê·œì¹™: null },
        { id: rid(), ì´ë¦„:"í˜„ëŒ€ìë™ì°¨", í‹°ì»¤:"005380", ë§¤ìˆ˜ê°€:210000, í˜„ì¬ê°€:205000, ê°œë³„ê·œì¹™: { ìµì ˆ:4.0, ì†ì ˆ:-3.0 } },
        { id: rid(), ì´ë¦„:"ì¹´ì¹´ì˜¤", í‹°ì»¤:"035720", ë§¤ìˆ˜ê°€:52000, í˜„ì¬ê°€:52260, ê°œë³„ê·œì¹™: null }
      ],
      ì¼ì§€: [
        { id: rid(), ts: Date.now()-1000*60*18, ìœ í˜•:"ë§¤ìˆ˜", ì¢…ëª©ID:null, ë‚´ìš©:"ê¸‰ë“±ì£¼ ë§ê³  ìš°ëŸ‰ì£¼ë§Œ. ë£°ëŒ€ë¡œë§Œ ê°„ë‹¤." },
        { id: rid(), ts: Date.now()-1000*60*6,  ìœ í˜•:"ê·œì¹™", ì¢…ëª©ID:null, ë‚´ìš©:"ê¸°ë³¸ ìµì ˆ +3~4%, ì†ì ˆ -3% ìœ ì§€. ì¶”ì²œì€ ê¸ˆì§€." }
      ]
    });

    function ë¶ˆëŸ¬ì˜¤ê¸°(){
      try{
        const raw = localStorage.getItem(STORAGE_KEY);
        if(!raw) return ê¸°ë³¸ìƒíƒœ();
        const s = JSON.parse(raw);
        if(!s.ê·œì¹™ || !Array.isArray(s.ì¢…ëª©) || !Array.isArray(s.ì¼ì§€)) return ê¸°ë³¸ìƒíƒœ();
        return s;
      }catch(e){ return ê¸°ë³¸ìƒíƒœ(); }
    }
    function ì €ì¥(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); }
    let state = ë¶ˆëŸ¬ì˜¤ê¸°();

    function í˜„ì¬ë¼ìš°íŠ¸(){
      const h = (location.hash || "#home").replace("#","");
      return routes.includes(h) ? h : "home";
    }
    function ì´ë™(route){ location.hash = "#" + route; }

    function escapeHtml(s){
      return String(s ?? "").replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;");
    }
    function truncate(s, n){
      if(!s) return "";
      return s.length > n ? s.slice(0,n-1) + "â€¦" : s;
    }
    function ìˆ«ìì›(n){
      if(n==null || Number.isNaN(Number(n))) return "-";
      return Number(n).toLocaleString("ko-KR");
    }
    function ìˆ˜ìµë¥ (í˜„ì¬ê°€, ë§¤ìˆ˜ê°€){
      if(!ë§¤ìˆ˜ê°€ || ë§¤ìˆ˜ê°€===0) return 0;
      return ((í˜„ì¬ê°€-ë§¤ìˆ˜ê°€)/ë§¤ìˆ˜ê°€)*100;
    }
    function ì ìš©ê·œì¹™(ìì‚°){
      return {
        ìµì ˆ: ìì‚°.ê°œë³„ê·œì¹™?.ìµì ˆ ?? state.ê·œì¹™.ìµì ˆ,
        ì†ì ˆ: ìì‚°.ê°œë³„ê·œì¹™?.ì†ì ˆ ?? state.ê·œì¹™.ì†ì ˆ
      };
    }
    function ê·œì¹™ì•Œë¦¼(ìì‚°){
      const p = ìˆ˜ìµë¥ (ìì‚°.í˜„ì¬ê°€, ìì‚°.ë§¤ìˆ˜ê°€);
      const {ìµì ˆ, ì†ì ˆ} = ì ìš©ê·œì¹™(ìì‚°);
      if(p >= ìµì ˆ) return { kind:"good", title:"âœ… ìµì ˆ ì¡°ê±´ ë„ë‹¬", msg:`${ìì‚°.ì´ë¦„} ${p.toFixed(1)}% (â‰¥ +${ìµì ˆ}%)` };
      if(p <= ì†ì ˆ) return { kind:"bad", title:"ğŸ›‘ ì†ì ˆ ì¡°ê±´ ë„ë‹¬", msg:`${ìì‚°.ì´ë¦„} ${p.toFixed(1)}% (â‰¤ ${ì†ì ˆ}%)` };
      if(p <= ì†ì ˆ + 0.6) return { kind:"bad", title:"âš  ì†ì ˆ ê·¼ì ‘", msg:`${ìì‚°.ì´ë¦„} ${p.toFixed(1)}% (ì†ì ˆ ${ì†ì ˆ}%)` };
      return null;
    }

    function mkMini(text, onClick, danger=false){
      const b = document.createElement("button");
      b.className = "mini" + (danger ? " danger" : "");
      b.textContent = text;
      b.addEventListener("click", onClick);
      return b;
    }

    function ì•Œë¦¼ì•„ì´í…œ(title, msg, when, kind){
      const el = document.createElement("div");
      el.className = "item";
      el.innerHTML = `
        <div class="l">
          <div class="name">${escapeHtml(title)}</div>
          <div class="meta">${escapeHtml(msg)}</div>
        </div>
        <div class="r">
          <div class="tag"><span class="dot ${kind==="good"?"good":"bad"}"></span>${escapeHtml(when)}</div>
        </div>
      `;
      return el;
    }

    function ì¢…ëª©ì•„ì´í…œ(a, compactButtons){
      const p = ìˆ˜ìµë¥ (a.í˜„ì¬ê°€, a.ë§¤ìˆ˜ê°€);
      const {ìµì ˆ, ì†ì ˆ} = ì ìš©ê·œì¹™(a);
      const chgClass = p>=ìµì ˆ ? "good" : (p<=ì†ì ˆ || p<=ì†ì ˆ+0.6 ? "bad" : "");
      const chgText = (p>=0?"+":"") + p.toFixed(1) + "%";
      const badge = p>=ìµì ˆ ? "âœ…" : (p<=ì†ì ˆ ? "ğŸ›‘" : (p<=ì†ì ˆ+0.6 ? "âš " : ""));

      const el = document.createElement("div");
      el.className = "item";
      el.innerHTML = `
        <div class="l">
          <div class="name">${escapeHtml(a.ì´ë¦„)} ${a.í‹°ì»¤?`<span class="small">(${escapeHtml(a.í‹°ì»¤)})</span>`:""}</div>
          <div class="meta">
            <span class="tag"><span class="dot good"></span> ìµì ˆ: +${ìµì ˆ}%</span>
            <span class="tag"><span class="dot bad"></span> ì†ì ˆ: ${ì†ì ˆ}%</span>
            <span class="tag">ë§¤ìˆ˜ê°€: ${ìˆ«ìì›(a.ë§¤ìˆ˜ê°€)}</span>
          </div>
        </div>
        <div class="r">
          <div class="price">${ìˆ«ìì›(a.í˜„ì¬ê°€)}</div>
          <div class="chg ${chgClass}">${chgText} ${badge}</div>
          <div class="mini-btns"></div>
        </div>
      `;
      const btns = $(".mini-btns", el);

      if(compactButtons){
        btns.append(
          mkMini("ê¸°ë¡", ()=>{ ì¼ì§€ì¶”ê°€("memo", a.id, `(${a.ì´ë¦„}) í˜„ì¬ê°€ ${ìˆ«ìì›(a.í˜„ì¬ê°€)} / ìˆ˜ìµë¥  ${chgText}`); ì´ë™("journal"); }),
          mkMini("ê°€ì´ë“œ", ()=>{ ë§¤ë„ê°€ì´ë“œ(a); })
        );
      }else{
        btns.append(
          mkMini("ê°€ê²©ìˆ˜ì •", ()=>{ ê°€ê²©ìˆ˜ì •(a.id); }),
          mkMini("ì‚­ì œ", ()=>{ ì¢…ëª©ì‚­ì œ(a.id); }, true)
        );
      }
      return el;
    }

    function ì¼ì§€ì•„ì´í…œ(j, compact=false, deletable=false){
      const el = document.createElement("div");
      el.className = "item";
      const a = j.ì¢…ëª©ID ? state.ì¢…ëª©.find(x=>x.id===j.ì¢…ëª©ID) : null;
      const dt = new Date(j.ts);
      const labelMap = { "ë§¤ìˆ˜":"ë§¤ìˆ˜ ì´ìœ ", "ë§¤ë„":"ë§¤ë„ ì´ìœ ", "ê·œì¹™":"ê·œì¹™ ë³€ê²½", "ë©”ëª¨":"ë©”ëª¨" };
      const title = labelMap[j.ìœ í˜•] || "ê¸°ë¡";
      el.innerHTML = `
        <div class="l">
          <div class="name">${title}${a ? ` â€” ${escapeHtml(a.ì´ë¦„)}` : ""}</div>
          <div class="meta">${escapeHtml(compact ? truncate(j.ë‚´ìš©, 60) : j.ë‚´ìš©)}</div>
        </div>
        <div class="r">
          <div class="tag">${dt.toLocaleString("ko-KR",{hour:"2-digit",minute:"2-digit"})}</div>
          <div class="mini-btns"></div>
        </div>
      `;
      const btns = $(".mini-btns", el);
      btns.append(mkMini("ì—´ê¸°", ()=>{
        $("#jType").value = (j.ìœ í˜•==="ë§¤ìˆ˜"?"buy":j.ìœ í˜•==="ë§¤ë„"?"sell":j.ìœ í˜•==="ê·œì¹™"?"rule":"memo");
        $("#jAsset").value = j.ì¢…ëª©ID || "";
        $("#jText").value = j.ë‚´ìš©;
        ì´ë™("journal");
      }));
      if(deletable){
        btns.append(mkMini("ì‚­ì œ", ()=>{ ì¼ì§€ì‚­ì œ(j.id); }, true));
      }
      return el;
    }

    function render(){
      const r = í˜„ì¬ë¼ìš°íŠ¸();

      routes.forEach(rt=>{
        const el = $("#page-"+rt);
        if(el) el.classList.toggle("active", rt===r);
      });
      $$(".nav a").forEach(a=> a.classList.toggle("active", a.dataset.route===r));

      $("#pillBanker").textContent = "ì€í–‰ì¥: " + (state.ì€í–‰ì¥?.ì´ë¦„ || "ë‚˜");
      $("#tagDefaultRules").innerHTML = `<span class="dot"></span> ê¸°ë³¸ ê·œì¹™: +${state.ê·œì¹™.ìµì ˆ}% / ${state.ê·œì¹™.ì†ì ˆ}%`;

      const alerts = state.ì¢…ëª©.map(ê·œì¹™ì•Œë¦¼).filter(Boolean);
      $("#kpiAlerts").textContent = alerts.length;
      $("#kpiAssets").textContent = state.ì¢…ëª©.length;

      const avgPL = state.ì¢…ëª©.length
        ? state.ì¢…ëª©.reduce((acc,a)=>acc + ìˆ˜ìµë¥ (a.í˜„ì¬ê°€,a.ë§¤ìˆ˜ê°€), 0) / state.ì¢…ëª©.length
        : 0;
      $("#kpiPL").textContent = (avgPL>=0?"+":"") + avgPL.toFixed(1) + "%";

      const ha = $("#homeAssets"); ha.innerHTML = "";
      if(state.ì¢…ëª©.length===0){
        ha.innerHTML = `<div class="note">ë“±ë¡ ì¢…ëª©ì´ ì—†ì–´. <span class="kbd">+ ì¢…ëª© ì¶”ê°€</span>ë¡œ ì‹œì‘í•´.</div>`;
      }else{
        state.ì¢…ëª©.slice(0,5).forEach(a=> ha.appendChild(ì¢…ëª©ì•„ì´í…œ(a, true)));
      }

      const hal = $("#homeAlerts"); hal.innerHTML = "";
      if(alerts.length===0){
        hal.appendChild(ì•Œë¦¼ì•„ì´í…œ("ì•Œë¦¼ ì—†ìŒ", "í˜„ì¬ ê·œì¹™ ì¡°ê±´ ì¶©ì¡± ì¢…ëª©ì´ ì—†ì–´.", "â€”", "good"));
      }else{
        alerts.slice(0,3).forEach(al=> hal.appendChild(ì•Œë¦¼ì•„ì´í…œ(al.title, al.msg, al.kind==="good"?"ë°©ê¸ˆ":"5ë¶„", al.kind)));
      }

      const hj = $("#homeJournal"); hj.innerHTML = "";
      const recent = [...state.ì¼ì§€].sort((a,b)=>b.ts-a.ts).slice(0,3);
      if(recent.length===0){
        hj.appendChild(ì•Œë¦¼ì•„ì´í…œ("ê¸°ë¡ ì—†ìŒ", "ë§¤ìˆ˜/ë§¤ë„ ì´ìœ ë¥¼ ë‚¨ê²¨ë´.", "â€”", "good"));
      }else{
        recent.forEach(j=> hj.appendChild(ì¼ì§€ì•„ì´í…œ(j, true, false)));
      }

      const alist = $("#assetsList"); alist.innerHTML = "";
      if(state.ì¢…ëª©.length===0){
        alist.innerHTML = `<div class="note">ì•„ì§ ì¢…ëª©ì´ ì—†ì–´. ìš°ëŸ‰ì£¼ë§Œ ì§ì ‘ ë“±ë¡í•´ë´.</div>`;
      }else{
        state.ì¢…ëª©.forEach(a=> alist.appendChild(ì¢…ëª©ì•„ì´í…œ(a, false)));
      }

      $("#alertsCountTag").textContent = `${alerts.length}ê±´`;
      const alh = $("#alertsList"); alh.innerHTML = "";
      if(alerts.length===0){
        alh.appendChild(ì•Œë¦¼ì•„ì´í…œ("ì•Œë¦¼ ì—†ìŒ", "ì¡°ê±´ ì¶©ì¡± ì¢…ëª©ì´ ì—†ì–´.", "â€”", "good"));
      }else{
        alerts.forEach(al=> alh.appendChild(ì•Œë¦¼ì•„ì´í…œ(al.title, al.msg, al.kind==="good"?"ë°©ê¸ˆ":"5ë¶„", al.kind)));
      }

      const sel = $("#jAsset");
      sel.innerHTML = `<option value="">(ì„ íƒ ì•ˆ í•¨)</option>` + state.ì¢…ëª©.map(a=>`<option value="${a.id}">${escapeHtml(a.ì´ë¦„)} (${escapeHtml(a.í‹°ì»¤||"-")})</option>`).join("");
      const jlist = $("#journalList"); jlist.innerHTML = "";
      const all = [...state.ì¼ì§€].sort((a,b)=>b.ts-a.ts);
      if(all.length===0){
        jlist.innerHTML = `<div class="note">ì•„ì§ ê¸°ë¡ì´ ì—†ì–´. ì´ìœ /ê·œì¹™/ê°ì •ê¹Œì§€ ë‚¨ê¸°ë©´ ë³µê¸°í•˜ê¸° ì¢‹ì•„.</div>`;
      }else{
        all.forEach(j=> jlist.appendChild(ì¼ì§€ì•„ì´í…œ(j, false, true)));
      }

      $("#ruleTP").value = state.ê·œì¹™.ìµì ˆ;
      $("#ruleSL").value = state.ê·œì¹™.ì†ì ˆ;

      const ovSel = $("#ovAsset");
      ovSel.innerHTML = state.ì¢…ëª©.map(a=>`<option value="${a.id}">${escapeHtml(a.ì´ë¦„)} (${escapeHtml(a.í‹°ì»¤||"-")})</option>`).join("") || `<option value="">(ì¢…ëª© ì—†ìŒ)</option>`;
      const hasAssets = state.ì¢…ëª©.length>0;
      ["ovTP","ovSL","ovSave","ovClear","ovAsset"].forEach(id=>{ const el = $("#"+id); if(el) el.disabled = !hasAssets; });

      if(hasAssets){
        const a = state.ì¢…ëª©.find(x=>x.id===ovSel.value) || state.ì¢…ëª©[0];
        if(a && ovSel.value !== a.id) ovSel.value = a.id;
        $("#ovTP").value = a.ê°œë³„ê·œì¹™?.ìµì ˆ ?? "";
        $("#ovSL").value = a.ê°œë³„ê·œì¹™?.ì†ì ˆ ?? "";
      } else {
        $("#ovTP").value = ""; $("#ovSL").value = "";
      }

      $("#bankerName").value = state.ì€í–‰ì¥?.ì´ë¦„ ?? "ë‚˜";
      $("#bankerPrinciple").value = state.ì€í–‰ì¥?.ì›ì¹™ ?? "";
    }

    function ëª¨ë‹¬ì—´ê¸°(show){
      $("#addModal").classList.toggle("show", show);
      if(show){ $("#aName").focus(); }
      else { $("#aName").value=""; $("#aTicker").value=""; $("#aAvg").value=""; $("#aNow").value=""; }
    }

    function ì¼ì§€ì¶”ê°€(type, ì¢…ëª©ID, ë‚´ìš©){
      const map = { buy:"ë§¤ìˆ˜", sell:"ë§¤ë„", rule:"ê·œì¹™", memo:"ë©”ëª¨" };
      const t = map[type] || "ë©”ëª¨";
      state.ì¼ì§€.unshift({ id: rid(), ts: Date.now(), ìœ í˜•: t, ì¢…ëª©ID, ë‚´ìš© });
      ì €ì¥();
    }

    function ì¢…ëª©ì¶”ê°€(){
      const name = $("#aName").value.trim();
      const ticker = $("#aTicker").value.trim();
      const avg = Number($("#aAvg").value);
      const now = Number($("#aNow").value);
      if(!name){ alert("ì¢…ëª©ëª…ì€ í•„ìˆ˜ì•¼"); return; }
      state.ì¢…ëª©.unshift({
        id: rid(),
        ì´ë¦„: name,
        í‹°ì»¤: ticker,
        ë§¤ìˆ˜ê°€: Number.isFinite(avg) ? avg : 0,
        í˜„ì¬ê°€: Number.isFinite(now) ? now : (Number.isFinite(avg) ? avg : 0),
        ê°œë³„ê·œì¹™: null
      });
      ì €ì¥();
      ëª¨ë‹¬ì—´ê¸°(false);
      ì¼ì§€ì¶”ê°€("memo", null, `ì¢…ëª© ì¶”ê°€: ${name}${ticker?` (${ticker})`:""}`);
      render();
    }

    function ì¢…ëª©ì‚­ì œ(id){
      const a = state.ì¢…ëª©.find(x=>x.id===id);
      if(!a) return;
      if(!confirm(`"${a.ì´ë¦„}" ì¢…ëª©ì„ ì‚­ì œí• ê¹Œ?`)) return;
      state.ì¢…ëª© = state.ì¢…ëª©.filter(x=>x.id!==id);
      state.ì¼ì§€ = state.ì¼ì§€.map(j => j.ì¢…ëª©ID===id ? ({...j, ì¢…ëª©ID:null}) : j);
      ì €ì¥();
      ì¼ì§€ì¶”ê°€("memo", null, `ì¢…ëª© ì‚­ì œ: ${a.ì´ë¦„}`);
      render();
    }

    function ê°€ê²©ìˆ˜ì •(id){
      const a = state.ì¢…ëª©.find(x=>x.id===id);
      if(!a) return;
      const avg = prompt(`${a.ì´ë¦„} ë§¤ìˆ˜ê°€(í‰ê· )`, String(a.ë§¤ìˆ˜ê°€ ?? ""));
      if(avg===null) return;
      const now = prompt(`${a.ì´ë¦„} í˜„ì¬ê°€(ëª¨ì˜)`, String(a.í˜„ì¬ê°€ ?? ""));
      if(now===null) return;
      a.ë§¤ìˆ˜ê°€ = Number(avg) || 0;
      a.í˜„ì¬ê°€ = Number(now) || 0;
      ì €ì¥();
      render();
    }

    function ëª¨ì˜ê°€ê²©(){
      state.ì¢…ëª©.forEach(a=>{
        const r = (Math.random()*6 - 3) / 100; // -3% ~ +3%
        a.í˜„ì¬ê°€ = Math.max(1, Math.round(a.í˜„ì¬ê°€ * (1 + r)));
      });
      ì €ì¥();
      render();
    }

    function ë§¤ë„ê°€ì´ë“œ(a){
      const p = ìˆ˜ìµë¥ (a.í˜„ì¬ê°€, a.ë§¤ìˆ˜ê°€);
      const {ìµì ˆ, ì†ì ˆ} = ì ìš©ê·œì¹™(a);
      alert([
        `ì¢…ëª©: ${a.ì´ë¦„} ${a.í‹°ì»¤?`(${a.í‹°ì»¤})`:""}`,
        `ë§¤ìˆ˜ê°€: ${ìˆ«ìì›(a.ë§¤ìˆ˜ê°€)}  í˜„ì¬ê°€: ${ìˆ«ìì›(a.í˜„ì¬ê°€)}  ìˆ˜ìµë¥ : ${(p>=0?"+":"")+p.toFixed(1)}%`,
        ``,
        `ê·œì¹™: ìµì ˆ +${ìµì ˆ}% / ì†ì ˆ ${ì†ì ˆ}%`,
        ``,
        (p>=ìµì ˆ) ? "âœ… ìµì ˆ ì¡°ê±´ ë„ë‹¬. (ê°€ì´ë“œ) ê·œì¹™ëŒ€ë¡œ ìµì ˆ ê³ ë ¤."
                 : (p<=ì†ì ˆ) ? "ğŸ›‘ ì†ì ˆ ì¡°ê±´ ë„ë‹¬. (ê°€ì´ë“œ) ê·œì¹™ëŒ€ë¡œ ì†ì ˆ ê³ ë ¤."
                 : (p<=ì†ì ˆ+0.6) ? "âš  ì†ì ˆ ê·¼ì ‘. ê·œì¹™ ì‹¤í–‰ ì¤€ë¹„."
                                 : "ì¡°ê±´ ë¯¸ì¶©ì¡±. ì•„ì§ì€ ëŒ€ê¸°."
      ].join("\n"));
    }

    function ì¼ì§€ì‚­ì œ(id){
      if(!confirm("ì´ ê¸°ë¡ì„ ì‚­ì œí• ê¹Œ?")) return;
      state.ì¼ì§€ = state.ì¼ì§€.filter(j=>j.id!==id);
      ì €ì¥();
      render();
    }

    function ê¸°ë³¸ê·œì¹™ì €ì¥(){
      const tp = Number($("#ruleTP").value);
      const sl = Number($("#ruleSL").value);
      if(!Number.isFinite(tp) || !Number.isFinite(sl)){
        alert("ê·œì¹™ ê°’ì€ ìˆ«ìì—¬ì•¼ í•´");
        return;
      }
      state.ê·œì¹™.ìµì ˆ = tp;
      state.ê·œì¹™.ì†ì ˆ = sl;
      ì €ì¥();
      ì¼ì§€ì¶”ê°€("rule", null, `ê¸°ë³¸ ê·œì¹™ ë³€ê²½: ìµì ˆ +${tp}% / ì†ì ˆ ${sl}%`);
      render();
    }
    function ê¸°ë³¸ê·œì¹™ì´ˆê¸°ê°’(){
      state.ê·œì¹™.ìµì ˆ = 3.5;
      state.ê·œì¹™.ì†ì ˆ = -3.0;
      ì €ì¥();
      render();
    }

    function ê°œë³„ê·œì¹™ì €ì¥(){
      const id = $("#ovAsset").value;
      const a = state.ì¢…ëª©.find(x=>x.id===id);
      if(!a) return;

      const tpRaw = $("#ovTP").value.trim();
      const slRaw = $("#ovSL").value.trim();
      const tp = tpRaw==="" ? null : Number(tpRaw);
      const sl = slRaw==="" ? null : Number(slRaw);

      if((tpRaw!=="" && !Number.isFinite(tp)) || (slRaw!=="" && !Number.isFinite(sl))){
        alert("ê°œë³„ ê·œì¹™ì€ ìˆ«ìê±°ë‚˜ ë¹„ì›Œì•¼ í•´");
        return;
      }

      a.ê°œë³„ê·œì¹™ = {
        ìµì ˆ: tp ?? state.ê·œì¹™.ìµì ˆ,
        ì†ì ˆ: sl ?? state.ê·œì¹™.ì†ì ˆ
      };
      ì €ì¥();
      ì¼ì§€ì¶”ê°€("rule", a.id, `ê°œë³„ ê·œì¹™ ì„¤ì •: ìµì ˆ +${a.ê°œë³„ê·œì¹™.ìµì ˆ}% / ì†ì ˆ ${a.ê°œë³„ê·œì¹™.ì†ì ˆ}%`);
      render();
    }

    function ê°œë³„ê·œì¹™í•´ì œ(){
      const id = $("#ovAsset").value;
      const a = state.ì¢…ëª©.find(x=>x.id===id);
      if(!a) return;
      a.ê°œë³„ê·œì¹™ = null;
      ì €ì¥();
      ì¼ì§€ì¶”ê°€("rule", a.id, "ê°œë³„ ê·œì¹™ í•´ì œ(ê¸°ë³¸ ê·œì¹™ ì‚¬ìš©)");
      render();
    }

    function ì„¤ì •ì €ì¥(){
      state.ì€í–‰ì¥.ì´ë¦„ = $("#bankerName").value.trim() || "ë‚˜";
      state.ì€í–‰ì¥.ì›ì¹™ = $("#bankerPrinciple").value;
      ì €ì¥();
      ì¼ì§€ì¶”ê°€("memo", null, "ì„¤ì • ì €ì¥");
      alert("ì €ì¥í–ˆì–´");
      render();
    }

    function JSONë‚´ë³´ë‚´ê¸°(){
      const blob = new Blob([JSON.stringify(state, null, 2)], {type:"application/json"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "myyieldbank_ë°ëª¨ë°ì´í„°.json";
      document.body.appendChild(a);
      a.click();
      a.remove();
      setTimeout(()=>URL.revokeObjectURL(url), 1000);
    }

    function JSONê°€ì ¸ì˜¤ê¸°(file){
      const reader = new FileReader();
      reader.onload = () => {
        try{
          const obj = JSON.parse(reader.result);
          if(!obj || !obj.ê·œì¹™ || !Array.isArray(obj.ì¢…ëª©) || !Array.isArray(obj.ì¼ì§€)){
            alert("JSON êµ¬ì¡°ê°€ ì˜¬ë°”ë¥´ì§€ ì•Šì•„");
            return;
          }
          state = obj;
          ì €ì¥();
          alert("ê°€ì ¸ì˜¤ê¸° ì™„ë£Œ");
          render();
        }catch(e){
          alert("ê°€ì ¸ì˜¤ê¸°ì— ì‹¤íŒ¨í–ˆì–´");
        }
      };
      reader.readAsText(file);
    }

    function ë¡œì»¬ì´ˆê¸°í™”(){
      if(!confirm("ë¡œì»¬ ë°ì´í„°ë¥¼ ëª¨ë‘ ì´ˆê¸°í™”í• ê¹Œ?")) return;
      localStorage.removeItem(STORAGE_KEY);
      state = ê¸°ë³¸ìƒíƒœ();
      ì €ì¥();
      alert("ì´ˆê¸°í™” ì™„ë£Œ");
      render();
    }

    // ì´ë²¤íŠ¸ ë°”ì¸ë”©
    $$(".nav a").forEach(a=>{
      a.addEventListener("click", ()=>{
        const rt = a.dataset.route;
        if(rt) ì´ë™(rt);
      });
    });

    $("#btnOpenAdd").addEventListener("click", ()=>ëª¨ë‹¬ì—´ê¸°(true));
    $("#btnGoSettings").addEventListener("click", ()=>ì´ë™("settings"));

    $("#qaAdd").addEventListener("click", ()=>ëª¨ë‹¬ì—´ê¸°(true));
    $("#qaRules").addEventListener("click", ()=>ì´ë™("rules"));
    $("#qaJournal").addEventListener("click", ()=>ì´ë™("journal"));
    $("#qaExport").addEventListener("click", JSONë‚´ë³´ë‚´ê¸°);

    $("#assetsAdd").addEventListener("click", ()=>ëª¨ë‹¬ì—´ê¸°(true));
    $("#assetsMock").addEventListener("click", ëª¨ì˜ê°€ê²©);

    $("#rulesSave").addEventListener("click", ê¸°ë³¸ê·œì¹™ì €ì¥);
    $("#rulesReset").addEventListener("click", ê¸°ë³¸ê·œì¹™ì´ˆê¸°ê°’);
    $("#ovAsset").addEventListener("change", render);
    $("#ovSave").addEventListener("click", ê°œë³„ê·œì¹™ì €ì¥);
    $("#ovClear").addEventListener("click", ê°œë³„ê·œì¹™í•´ì œ);

    $("#journalNew").addEventListener("click", ()=>$("#jText").focus());
    $("#journalClear").addEventListener("click", ()=>{ $("#jText").value=""; $("#jAsset").value=""; $("#jType").value="buy"; });
    $("#journalSave").addEventListener("click", ()=>{
      const type = $("#jType").value;
      const assetId = $("#jAsset").value || null;
      const text = $("#jText").value.trim();
      if(!text){ alert("ê¸°ë¡ ë‚´ìš©ì´ ë¹„ì–´ìˆì–´"); return; }
      state.ì¼ì§€.unshift({
        id: rid(),
        ts: Date.now(),
        ìœ í˜•: (type==="buy"?"ë§¤ìˆ˜":type==="sell"?"ë§¤ë„":type==="rule"?"ê·œì¹™":"ë©”ëª¨"),
        ì¢…ëª©ID: assetId,
        ë‚´ìš©: text
      });
      ì €ì¥();
      $("#jText").value = "";
      render();
    });

    $("#saveSettings").addEventListener("click", ì„¤ì •ì €ì¥);
    $("#wipeAll").addEventListener("click", ë¡œì»¬ì´ˆê¸°í™”);
    $("#exportBtn").addEventListener("click", JSONë‚´ë³´ë‚´ê¸°);
    $("#importBtn").addEventListener("click", ()=>$("#importFile").click());
    $("#importFile").addEventListener("change", (e)=>{
      const f = e.target.files?.[0];
      if(f) JSONê°€ì ¸ì˜¤ê¸°(f);
      e.target.value = "";
    });

    $("#addClose").addEventListener("click", ()=>ëª¨ë‹¬ì—´ê¸°(false));
    $("#addCancel").addEventListener("click", ()=>ëª¨ë‹¬ì—´ê¸°(false));
    $("#addSave").addEventListener("click", ì¢…ëª©ì¶”ê°€);
    $("#addModal").addEventListener("click", (e)=>{ if(e.target.id==="addModal") ëª¨ë‹¬ì—´ê¸°(false); });

    window.addEventListener("keydown", (e)=>{
      if(e.key==="Escape") ëª¨ë‹¬ì—´ê¸°(false);
      if((e.ctrlKey || e.metaKey) && e.key.toLowerCase()==="k"){
        e.preventDefault();
        ëª¨ë‹¬ì—´ê¸°(true);
      }
    });

    window.addEventListener("hashchange", render);

    if(!location.hash) location.hash = "#home";
    render();
  </script>
</body>
</html>
